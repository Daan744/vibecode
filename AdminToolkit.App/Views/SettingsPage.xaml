<Page x:Class="AdminToolkit.App.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Settings">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32,24,32,32" MaxWidth="600" HorizontalAlignment="Left">

            <TextBlock Text="Settings" FontSize="28" FontWeight="SemiBold" Margin="0,0,0,24" />

            <!-- Tenant -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock Text="Default Tenant" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,4" />
                    <TextBlock Opacity="0.5" TextWrapping="Wrap" Margin="0,0,0,16" LineHeight="20">
                        Use 'organizations' for MSP multi-tenant sign-in, or enter a
                        specific tenant ID / domain (e.g. contoso.onmicrosoft.com) to
                        default to one customer.
                    </TextBlock>

                    <ui:TextBox Text="{Binding TenantId, UpdateSourceTrigger=PropertyChanged}"
                                PlaceholderText="organizations"
                                Margin="0,0,0,16" />

                    <ui:Button Content="Save" Appearance="Primary"
                               Command="{Binding SaveSettingsCommand}" MinWidth="120" />
                </StackPanel>
            </Border>

            <!-- Theme -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24" Margin="0,0,0,20">
                <DockPanel>
                    <StackPanel>
                        <TextBlock Text="Theme" FontWeight="SemiBold" FontSize="16" />
                        <TextBlock Text="Toggle between dark and light theme" Opacity="0.6" Margin="0,4,0,0" />
                    </StackPanel>
                    <ui:Button DockPanel.Dock="Right" Content="Toggle Theme" Appearance="Secondary"
                               Command="{Binding ToggleThemeCommand}" VerticalAlignment="Center" />
                </DockPanel>
            </Border>

            <!-- About -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24">
                <StackPanel>
                    <TextBlock Text="About" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,8" />
                    <TextBlock Opacity="0.6" TextWrapping="Wrap" LineHeight="20">
                        O365 Admin Toolkit v1.0 â€” Built for MSPs.
                        Uses Microsoft Graph SDK + MSAL with delegated permissions.
                        No app registration required. No passwords or tokens stored.
                        Connect to any customer tenant with your admin credentials.
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
