<Page x:Class="AdminToolkit.App.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Settings">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32,24,32,32" MaxWidth="600" HorizontalAlignment="Left">

            <TextBlock Text="Settings" FontSize="28" FontWeight="SemiBold" Margin="0,0,0,24" />

            <!-- Auth Settings -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock Text="Authentication" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,4" />
                    <TextBlock Opacity="0.5" TextWrapping="Wrap" Margin="0,0,0,16" LineHeight="20">
                        This app uses a well-known Microsoft public client ID by default.
                        No app registration is required. Just sign in with your admin account.
                        If you have your own registered app, you can override the Client ID below.
                    </TextBlock>

                    <TextBlock Text="Client ID (optional override)" Opacity="0.7" FontSize="12" Margin="0,0,0,4" />
                    <ui:TextBox Text="{Binding ClientId, UpdateSourceTrigger=PropertyChanged}"
                                PlaceholderText="14d82eec-204b-4c2f-b7e8-296a70dab67e"
                                Margin="0,0,0,16" />

                    <TextBlock Text="Default Tenant" Opacity="0.7" FontSize="12" Margin="0,0,0,4" />
                    <TextBlock Text="Use 'organizations' for MSP multi-tenant, or enter a specific tenant ID/domain."
                               Opacity="0.5" FontSize="11" Margin="0,0,0,4" TextWrapping="Wrap" />
                    <ui:TextBox Text="{Binding TenantId, UpdateSourceTrigger=PropertyChanged}"
                                PlaceholderText="organizations"
                                Margin="0,0,0,16" />

                    <ui:Button Content="Save Settings" Appearance="Primary"
                               Command="{Binding SaveSettingsCommand}" MinWidth="160" />
                </StackPanel>
            </Border>

            <!-- Theme -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24" Margin="0,0,0,20">
                <DockPanel>
                    <StackPanel>
                        <TextBlock Text="Theme" FontWeight="SemiBold" FontSize="16" />
                        <TextBlock Text="Toggle between dark and light theme" Opacity="0.6" Margin="0,4,0,0" />
                    </StackPanel>
                    <ui:Button DockPanel.Dock="Right" Content="Toggle Theme" Appearance="Secondary"
                               Command="{Binding ToggleThemeCommand}" VerticalAlignment="Center" />
                </DockPanel>
            </Border>

            <!-- Info -->
            <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                    CornerRadius="8" Padding="24">
                <StackPanel>
                    <TextBlock Text="About" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,8" />
                    <TextBlock Opacity="0.6" TextWrapping="Wrap" LineHeight="20">
                        O365 Admin Toolkit v1.0 â€” Built for MSPs.
                        Uses Microsoft Graph SDK + MSAL with delegated permissions.
                        No app registration required. No passwords or tokens stored.
                        Connect to any customer tenant with your admin credentials.
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
